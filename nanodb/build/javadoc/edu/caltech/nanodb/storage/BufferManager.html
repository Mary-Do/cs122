<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_111) on Wed Jan 18 13:25:14 PST 2017 -->
<title>BufferManager (NanoDB)</title>
<meta name="date" content="2017-01-18">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="BufferManager (NanoDB)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10,"i19":10,"i20":10,"i21":10};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../edu/caltech/nanodb/storage/BufferManager.BufferManagerPropertyHandler.html" title="class in edu.caltech.nanodb.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/caltech/nanodb/storage/BufferManager.html" target="_top">Frames</a></li>
<li><a href="BufferManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.caltech.nanodb.storage</div>
<h2 title="Class BufferManager" class="title">Class BufferManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>edu.caltech.nanodb.storage.BufferManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.35">BufferManager</a>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block">The buffer manager reduces the number of disk IO operations by managing an
 in-memory cache of data pages.  It also imposes a limit on the maximum
 amount of space that can be used for data pages in the database.</div>
<dl>
<dt><span class="simpleTagLabel">To Do:</span></dt>
<dd>Eventually add integrity checks, e.g. to make sure every cached
       page's file appears in the collection of cached files.</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="nested.class.summary">
<!--   -->
</a>
<h3>Nested Class Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Nested Class Summary table, listing nested classes, and an explanation">
<caption><span>Nested Classes</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Class and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.BufferManagerPropertyHandler.html" title="class in edu.caltech.nanodb.storage">BufferManager.BufferManagerPropertyHandler</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.CachedPageInfo.html" title="class in edu.caltech.nanodb.storage">BufferManager.CachedPageInfo</a></span></code>
<div class="block">This helper class keeps track of a data page that is currently cached.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.DBPageID.html" title="class in edu.caltech.nanodb.storage">BufferManager.DBPageID</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static class&nbsp;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.SessionPinCount.html" title="class in edu.caltech.nanodb.storage">BufferManager.SessionPinCount</a></span></code>
<div class="block">This helper class records the pin-count of a data page as imposed by a
 given session, so that we can forcibly release the session's pins after
 each command the session completes.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html?is-external=true" title="class or interface in java.util">HashSet</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#allocatedBuffers">allocatedBuffers</a></span></code>
<div class="block">This set holds the identity hash-code of every buffer allocated by the
 Buffer Manager, so that it can verify that buffers being freed are
 actually from this Buffer Manager.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html?is-external=true" title="class or interface in java.util">LinkedHashMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#cachedFiles">cachedFiles</a></span></code>
<div class="block">This collection holds the <a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> objects corresponding to various
 opened files the database is currently using.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html?is-external=true" title="class or interface in java.util">LinkedHashMap</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManager.CachedPageInfo.html" title="class in edu.caltech.nanodb.storage">BufferManager.CachedPageInfo</a>,<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#cachedPages">cachedPages</a></span></code>
<div class="block">This collection holds database pages (not WAL pages) that the database
 is currently working with, so that they don't continually need to be
 reloaded.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#DEFAULT_PAGECACHE_POLICY">DEFAULT_PAGECACHE_POLICY</a></span></code>
<div class="block">The default page-cache policy is LRU.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#DEFAULT_PAGECACHE_SIZE">DEFAULT_PAGECACHE_SIZE</a></span></code>
<div class="block">The default page-cache size is defined to be 20MB.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../edu/caltech/nanodb/storage/FileManager.html" title="interface in edu.caltech.nanodb.storage">FileManager</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#fileManager">fileManager</a></span></code>&nbsp;</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html?is-external=true" title="class or interface in org.apache.log4j">Logger</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#logger">logger</a></span></code>
<div class="block">A logging object for reporting anything interesting that happens.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#maxCacheSize">maxCacheSize</a></span></code>
<div class="block">This field records the maximum allowed cache size.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html?is-external=true" title="class or interface in java.util">ArrayList</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManagerObserver.html" title="interface in edu.caltech.nanodb.storage">BufferManagerObserver</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#observers">observers</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#PROP_PAGECACHE_POLICY">PROP_PAGECACHE_POLICY</a></span></code>
<div class="block">The system property that can be used to specify the page replacement
 policy in the buffer manager.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#PROP_PAGECACHE_SIZE">PROP_PAGECACHE_SIZE</a></span></code>
<div class="block">The system property that can be used to specify the size of the page
 cache in the buffer manager.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#replacementPolicy">replacementPolicy</a></span></code>
<div class="block">A string indicating the buffer manager's page replacement policy.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html?is-external=true" title="class or interface in java.util">HashMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>,<a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html?is-external=true" title="class or interface in java.util">HashMap</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManager.DBPageID.html" title="class in edu.caltech.nanodb.storage">BufferManager.DBPageID</a>,<a href="../../../../edu/caltech/nanodb/storage/BufferManager.SessionPinCount.html" title="class in edu.caltech.nanodb.storage">BufferManager.SessionPinCount</a>&gt;&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#sessionPinCounts">sessionPinCounts</a></span></code>
<div class="block">This collection maps session IDs to the files and pages that each
 session has pinned, so that we can forcibly unpin pages used by a
 given session when the session is done with the current command.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#totalBytesCached">totalBytesCached</a></span></code>
<div class="block">This field records how many bytes are currently cached, in total.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#BufferManager-edu.caltech.nanodb.server.NanoDBServer-edu.caltech.nanodb.storage.FileManager-">BufferManager</a></span>(<a href="../../../../edu/caltech/nanodb/server/NanoDBServer.html" title="class in edu.caltech.nanodb.server">NanoDBServer</a>&nbsp;server,
             <a href="../../../../edu/caltech/nanodb/storage/FileManager.html" title="interface in edu.caltech.nanodb.storage">FileManager</a>&nbsp;fileManager)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#addFile-edu.caltech.nanodb.storage.DBFile-">addFile</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)</code>&nbsp;</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#addObserver-edu.caltech.nanodb.storage.BufferManagerObserver-">addObserver</a></span>(<a href="../../../../edu/caltech/nanodb/storage/BufferManagerObserver.html" title="interface in edu.caltech.nanodb.storage">BufferManagerObserver</a>&nbsp;obs)</code>
<div class="block">Add another observer to the buffer manager.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#addPage-edu.caltech.nanodb.storage.DBPage-">addPage</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</code>
<div class="block">
 Adds a new, previously unbuffered <code>DBPage</code> to the Buffer Manager.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#allocBuffer-int-">allocBuffer</a></span>(int&nbsp;size)</code>
<div class="block">This method attempts to allocate a buffer of the specified size,
 possibly evicting some existing buffers in order to make space.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#configureMaxCacheSize--">configureMaxCacheSize</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#configureReplacementPolicy--">configureReplacementPolicy</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#ensureSpaceAvailable-int-">ensureSpaceAvailable</a></span>(int&nbsp;bytesRequired)</code>
<div class="block">This helper function ensures that the buffer manager has the specified
 amount of space available.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#flushAll--">flushAll</a></span>()</code>
<div class="block">This method removes all cached pages from the buffer manager, writing
 out any dirty pages in the process.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#flushDBFile-edu.caltech.nanodb.storage.DBFile-">flushDBFile</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)</code>
<div class="block">This method removes all cached pages in the specified file from the
 buffer manager, writing out any dirty pages in the process.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code><a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#getFile-java.lang.String-">getFile</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;filename)</code>
<div class="block">Retrieves the specified <a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> from the buffer manager, if it has
 already been opened.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#getPage-edu.caltech.nanodb.storage.DBFile-int-">getPage</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
       int&nbsp;pageNo)</code>
<div class="block">Retrieves the specified <code>DBPage</code> from the Buffer Manager if it's
 currently buffered, or <code>null</code> if the page is not currently
 buffered.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#recordPageInvalidated-edu.caltech.nanodb.storage.DBPage-">recordPageInvalidated</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</code>&nbsp;</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#recordPagePinned-edu.caltech.nanodb.storage.DBPage-">recordPagePinned</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</code>
<div class="block">Records that the page was pinned by the current session.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#recordPageUnpinned-edu.caltech.nanodb.storage.DBPage-">recordPageUnpinned</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</code>
<div class="block">Records that the page was unpinned by the current session.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#releaseBuffer-byte:A-">releaseBuffer</a></span>(byte[]&nbsp;buffer)</code>&nbsp;</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#removeAll--">removeAll</a></span>()</code>
<div class="block">This method removes ALL files from the cache, first flushing all pages
 from the cache so that any dirty pages will be saved to disk (possibly
 updating the write-ahead log in the process).</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#removeDBFile-edu.caltech.nanodb.storage.DBFile-">removeDBFile</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)</code>
<div class="block">This method removes a file from the cache, first flushing all pages from
 the file out of the cache.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#unpinAllSessionPages--">unpinAllSessionPages</a></span>()</code>
<div class="block">This method unpins all pages pinned by the current session.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeAll-boolean-">writeAll</a></span>(boolean&nbsp;sync)</code>
<div class="block">This method writes all dirty pages in the buffer manager to disk.</div>
</td>
</tr>
<tr id="i19" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeDBFile-edu.caltech.nanodb.storage.DBFile-boolean-">writeDBFile</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
           boolean&nbsp;sync)</code>
<div class="block">This method writes all dirty pages in the specified file, optionally
 syncing the file after performing the write.</div>
</td>
</tr>
<tr id="i20" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeDBFile-edu.caltech.nanodb.storage.DBFile-int-int-boolean-">writeDBFile</a></span>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
           int&nbsp;minPageNo,
           int&nbsp;maxPageNo,
           boolean&nbsp;sync)</code>
<div class="block">This method writes all dirty pages in the specified file, optionally
 syncing the file after performing the write.</div>
</td>
</tr>
<tr id="i21" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeDirtyPages-java.util.List-boolean-">writeDirtyPages</a></span>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&gt;&nbsp;dirtyPages,
               boolean&nbsp;invalidate)</code>
<div class="block">This helper method writes out a list of dirty pages from the buffer
 manager, ensuring that if transactions are enabled, the
 write-ahead-logging rule is satisfied.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="PROP_PAGECACHE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_PAGECACHE_SIZE</h4>
<pre>public static final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.41">PROP_PAGECACHE_SIZE</a></pre>
<div class="block">The system property that can be used to specify the size of the page
 cache in the buffer manager.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.caltech.nanodb.storage.BufferManager.PROP_PAGECACHE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEFAULT_PAGECACHE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_PAGECACHE_SIZE</h4>
<pre>public static final&nbsp;long <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.44">DEFAULT_PAGECACHE_SIZE</a></pre>
<div class="block">The default page-cache size is defined to be 20MB.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.caltech.nanodb.storage.BufferManager.DEFAULT_PAGECACHE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="PROP_PAGECACHE_POLICY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>PROP_PAGECACHE_POLICY</h4>
<pre>public static final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.51">PROP_PAGECACHE_POLICY</a></pre>
<div class="block">The system property that can be used to specify the page replacement
 policy in the buffer manager.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.caltech.nanodb.storage.BufferManager.PROP_PAGECACHE_POLICY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="DEFAULT_PAGECACHE_POLICY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_PAGECACHE_POLICY</h4>
<pre>public static final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.54">DEFAULT_PAGECACHE_POLICY</a></pre>
<div class="block">The default page-cache policy is LRU.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../constant-values.html#edu.caltech.nanodb.storage.BufferManager.DEFAULT_PAGECACHE_POLICY">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>private static&nbsp;<a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html?is-external=true" title="class or interface in org.apache.log4j">Logger</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.184">logger</a></pre>
<div class="block">A logging object for reporting anything interesting that happens.</div>
</li>
</ul>
<a name="fileManager">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>fileManager</h4>
<pre>private&nbsp;<a href="../../../../edu/caltech/nanodb/storage/FileManager.html" title="interface in edu.caltech.nanodb.storage">FileManager</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.187">fileManager</a></pre>
</li>
</ul>
<a name="observers">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>observers</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/ArrayList.html?is-external=true" title="class or interface in java.util">ArrayList</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManagerObserver.html" title="interface in edu.caltech.nanodb.storage">BufferManagerObserver</a>&gt; <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.190">observers</a></pre>
</li>
</ul>
<a name="cachedFiles">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cachedFiles</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html?is-external=true" title="class or interface in java.util">LinkedHashMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&gt; <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.197">cachedFiles</a></pre>
<div class="block">This collection holds the <a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> objects corresponding to various
 opened files the database is currently using.</div>
</li>
</ul>
<a name="cachedPages">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cachedPages</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/LinkedHashMap.html?is-external=true" title="class or interface in java.util">LinkedHashMap</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManager.CachedPageInfo.html" title="class in edu.caltech.nanodb.storage">BufferManager.CachedPageInfo</a>,<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&gt; <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.205">cachedPages</a></pre>
<div class="block">This collection holds database pages (not WAL pages) that the database
 is currently working with, so that they don't continually need to be
 reloaded.</div>
</li>
</ul>
<a name="sessionPinCounts">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sessionPinCounts</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html?is-external=true" title="class or interface in java.util">HashMap</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>,<a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashMap.html?is-external=true" title="class or interface in java.util">HashMap</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/BufferManager.DBPageID.html" title="class in edu.caltech.nanodb.storage">BufferManager.DBPageID</a>,<a href="../../../../edu/caltech/nanodb/storage/BufferManager.SessionPinCount.html" title="class in edu.caltech.nanodb.storage">BufferManager.SessionPinCount</a>&gt;&gt; <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.213">sessionPinCounts</a></pre>
<div class="block">This collection maps session IDs to the files and pages that each
 session has pinned, so that we can forcibly unpin pages used by a
 given session when the session is done with the current command.</div>
</li>
</ul>
<a name="allocatedBuffers">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allocatedBuffers</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html?is-external=true" title="class or interface in java.util">HashSet</a>&lt;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Integer.html?is-external=true" title="class or interface in java.lang">Integer</a>&gt; <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.223">allocatedBuffers</a></pre>
<div class="block">This set holds the identity hash-code of every buffer allocated by the
 Buffer Manager, so that it can verify that buffers being freed are
 actually from this Buffer Manager.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/System.html?is-external=true#identityHashCode-java.lang.Object-" title="class or interface in java.lang"><code>System.identityHashCode(java.lang.Object)</code></a></dd>
</dl>
</li>
</ul>
<a name="totalBytesCached">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>totalBytesCached</h4>
<pre>private&nbsp;long <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.227">totalBytesCached</a></pre>
<div class="block">This field records how many bytes are currently cached, in total.</div>
</li>
</ul>
<a name="maxCacheSize">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>maxCacheSize</h4>
<pre>private&nbsp;long <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.231">maxCacheSize</a></pre>
<div class="block">This field records the maximum allowed cache size.</div>
</li>
</ul>
<a name="replacementPolicy">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>replacementPolicy</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.238">replacementPolicy</a></pre>
<div class="block">A string indicating the buffer manager's page replacement policy.
 Currently it can be "lru" or "fifo".</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="BufferManager-edu.caltech.nanodb.server.NanoDBServer-edu.caltech.nanodb.storage.FileManager-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>BufferManager</h4>
<pre>public&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.241">BufferManager</a>(<a href="../../../../edu/caltech/nanodb/server/NanoDBServer.html" title="class in edu.caltech.nanodb.server">NanoDBServer</a>&nbsp;server,
                     <a href="../../../../edu/caltech/nanodb/storage/FileManager.html" title="interface in edu.caltech.nanodb.storage">FileManager</a>&nbsp;fileManager)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="configureMaxCacheSize--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>configureMaxCacheSize</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.267">configureMaxCacheSize</a>()</pre>
</li>
</ul>
<a name="configureReplacementPolicy--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>configureReplacementPolicy</h4>
<pre>private&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.309">configureReplacementPolicy</a>()</pre>
</li>
</ul>
<a name="addObserver-edu.caltech.nanodb.storage.BufferManagerObserver-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addObserver</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.331">addObserver</a>(<a href="../../../../edu/caltech/nanodb/storage/BufferManagerObserver.html" title="interface in edu.caltech.nanodb.storage">BufferManagerObserver</a>&nbsp;obs)</pre>
<div class="block">Add another observer to the buffer manager.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>obs</code> - the observer to add to the buffer manager</dd>
</dl>
</li>
</ul>
<a name="allocBuffer-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>allocBuffer</h4>
<pre>public&nbsp;byte[]&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.351">allocBuffer</a>(int&nbsp;size)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method attempts to allocate a buffer of the specified size,
 possibly evicting some existing buffers in order to make space.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>size</code> - the size of the buffer to allocate</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>an array of bytes, of the specified size</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if a dirty page must be evicted from the buffer
         manager, and an IO error occurred while writing the page to
         persistent storage.</dd>
</dl>
</li>
</ul>
<a name="releaseBuffer-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>releaseBuffer</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.378">releaseBuffer</a>(byte[]&nbsp;buffer)</pre>
</li>
</ul>
<a name="getFile-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFile</h4>
<pre>public&nbsp;<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.407">getFile</a>(<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;filename)</pre>
<div class="block">Retrieves the specified <a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> from the buffer manager, if it has
 already been opened.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>filename</code> - The filename of the database file to retrieve.  This
        should be ONLY the database filename, no path.  The path is
        expected to be relative to the database's base directory.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the <a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> corresponding to the filename, if it has
         already been opened, or <tt>null</tt> if the file isn't currently
         open.</dd>
</dl>
</li>
</ul>
<a name="addFile-edu.caltech.nanodb.storage.DBFile-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.418">addFile</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)</pre>
</li>
</ul>
<a name="recordPagePinned-edu.caltech.nanodb.storage.DBPage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordPagePinned</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.444">recordPagePinned</a>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</pre>
<div class="block">Records that the page was pinned by the current session.  This method
 does not actually pin the page; it is presumed that the page is already
 pinned.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbPage</code> - the page that was pinned by the session</dd>
</dl>
</li>
</ul>
<a name="recordPageUnpinned-edu.caltech.nanodb.storage.DBPage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordPageUnpinned</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.474">recordPageUnpinned</a>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</pre>
<div class="block">Records that the page was unpinned by the current session.  This method
 does not actually unpin the page; it is presumed that the page will be
 unpinned after this call.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbPage</code> - the page that was unpinned</dd>
</dl>
</li>
</ul>
<a name="unpinAllSessionPages--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>unpinAllSessionPages</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.517">unpinAllSessionPages</a>()</pre>
<div class="block">This method unpins all pages pinned by the current session.  This is
 generally done at the end of each transaction so that pages aren't
 pinned forever, and can actually be evicted from the buffer manager.</div>
</li>
</ul>
<a name="recordPageInvalidated-edu.caltech.nanodb.storage.DBPage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>recordPageInvalidated</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.551">recordPageInvalidated</a>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</pre>
</li>
</ul>
<a name="getPage-edu.caltech.nanodb.storage.DBFile-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getPage</h4>
<pre>public&nbsp;<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.585">getPage</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
                      int&nbsp;pageNo)</pre>
<div class="block">Retrieves the specified <code>DBPage</code> from the Buffer Manager if it's
 currently buffered, or <code>null</code> if the page is not currently
 buffered.  If a page is returned, it is pinned before it is returned.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbFile</code> - the file containing the page to retrieve</dd>
<dd><code>pageNo</code> - the page number in the <code>DBFile</code> to retrieve</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the requested <code>DBPage</code>, or <code>null</code> if not found</dd>
</dl>
</li>
</ul>
<a name="addPage-edu.caltech.nanodb.storage.DBPage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>addPage</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.617">addPage</a>(<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)
             throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block"><p>
 Adds a new, previously unbuffered <code>DBPage</code> to the Buffer Manager.
 The page is pinned during the operation.
 </p>
 <p>
 It is an error if the page is already in the Buffer Manager when this
 method is called.
 </p></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbPage</code> - the page to add to the Buffer Manager</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if the page already appears in the Buffer
         Manager.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="ensureSpaceAvailable-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ensureSpaceAvailable</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.655">ensureSpaceAvailable</a>(int&nbsp;bytesRequired)
                           throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper function ensures that the buffer manager has the specified
 amount of space available.  This is done by removing pages out of the
 buffer manager's cache</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>bytesRequired</code> - the amount of space that should be made available
        in the cache, in bytes</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs when flushing dirty pages out
         to disk</dd>
</dl>
</li>
</ul>
<a name="writeDirtyPages-java.util.List-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeDirtyPages</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.720">writeDirtyPages</a>(<a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&gt;&nbsp;dirtyPages,
                             boolean&nbsp;invalidate)
                      throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper method writes out a list of dirty pages from the buffer
 manager, ensuring that if transactions are enabled, the
 write-ahead-logging rule is satisfied.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dirtyPages</code> - the list of dirty pages to write</dd>
<dd><code>invalidate</code> - if true then the dirty pages are invalidated so they
        must be reloaded from disk</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while flushing dirty pages</dd>
</dl>
</li>
</ul>
<a name="writeDBFile-edu.caltech.nanodb.storage.DBFile-int-int-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeDBFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.768">writeDBFile</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
                        int&nbsp;minPageNo,
                        int&nbsp;maxPageNo,
                        boolean&nbsp;sync)
                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes all dirty pages in the specified file, optionally
 syncing the file after performing the write.  The pages are not removed
 from the buffer manager after writing them; their dirty state is simply
 cleared.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbFile</code> - the file whose dirty pages should be written to disk</dd>
<dd><code>minPageNo</code> - dirty pages with a page-number less than this value
        will not be written to disk</dd>
<dd><code>maxPageNo</code> - dirty pages with a page-number greater than this value
        will not be written to disk</dd>
<dd><code>sync</code> - If true then the database file will be sync'd to disk;
        if false then no sync will occur.  The sync will always occur,
        in case dirty pages had previously been flushed to disk without
        syncing.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while updating the write-ahead
         log, or while writing the file's contents.</dd>
</dl>
</li>
</ul>
<a name="writeDBFile-edu.caltech.nanodb.storage.DBFile-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeDBFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.824">writeDBFile</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile,
                        boolean&nbsp;sync)
                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes all dirty pages in the specified file, optionally
 syncing the file after performing the write.  The pages are not removed
 from the buffer manager after writing them; their dirty state is simply
 cleared.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbFile</code> - the file whose dirty pages should be written to disk</dd>
<dd><code>sync</code> - If true then the database file will be sync'd to disk;
        if false then no sync will occur.  The sync will always occur,
        in case dirty pages had previously been flushed to disk without
        syncing.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while updating the write-ahead
         log, or while writing the file's contents.</dd>
</dl>
</li>
</ul>
<a name="writeAll-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeAll</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.842">writeAll</a>(boolean&nbsp;sync)
              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes all dirty pages in the buffer manager to disk.  The
 pages are not removed from the buffer manager after writing them; their
 dirty state is simply cleared.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>sync</code> - if true, this method will sync all files in which dirty pages
        were found, with the exception of WAL files and the
        transaction-state file.  If false, no file syncing will be
        performed.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while updating the write-ahead
         log, or while writing the file's contents.</dd>
</dl>
</li>
</ul>
<a name="flushDBFile-edu.caltech.nanodb.storage.DBFile-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushDBFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.894">flushDBFile</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)
                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method removes all cached pages in the specified file from the
 buffer manager, writing out any dirty pages in the process.  This method
 is not generally recommended to be used, as it basically defeats the
 purpose of the buffer manager in the first place; rather, the
 <a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeDBFile-edu.caltech.nanodb.storage.DBFile-int-int-boolean-"><code>writeDBFile(edu.caltech.nanodb.storage.DBFile, int, int, boolean)</code></a> method should be used instead.  There is a specific
 situation in which it is used, when a file is being removed from the
 Buffer Manager by the Storage Manager.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbFile</code> - the file whose pages should be flushed from the cache</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while updating the write-ahead
         log, or the file's contents</dd>
</dl>
</li>
</ul>
<a name="flushAll--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>flushAll</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.947">flushAll</a>()
              throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method removes all cached pages from the buffer manager, writing
 out any dirty pages in the process.  This method is not generally
 recommended to be used, as it basically defeats the purpose of the
 buffer manager in the first place; rather, the <a href="../../../../edu/caltech/nanodb/storage/BufferManager.html#writeAll-boolean-"><code>writeAll(boolean)</code></a> method
 should be used instead.  However, this method is useful to cause certain
 performance issues to manifest with individual commands, and the Storage
 Manager also uses it during shutdown processing to ensure all data is
 saved to disk.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while updating the write-ahead
         log, or the file's contents</dd>
</dl>
</li>
</ul>
<a name="removeDBFile-edu.caltech.nanodb.storage.DBFile-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>removeDBFile</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.992">removeDBFile</a>(<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;dbFile)
                  throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method removes a file from the cache, first flushing all pages from
 the file out of the cache.  This operation is used by the Storage Manager
 to close a data file.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbFile</code> - the file to remove from the cache.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while writing out dirty pages</dd>
</dl>
</li>
</ul>
<a name="removeAll--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>removeAll</h4>
<pre>public&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/util/List.html?is-external=true" title="class or interface in java.util">List</a>&lt;<a href="../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&gt;&nbsp;<a href="../../../../src-html/edu/caltech/nanodb/storage/BufferManager.html#line.1010">removeAll</a>()
                       throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method removes ALL files from the cache, first flushing all pages
 from the cache so that any dirty pages will be saved to disk (possibly
 updating the write-ahead log in the process).  This operation is used by
 the Storage Manager during shutdown.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a list of the files that were in the cache, so that they can be
         used by the caller if necessary (e.g. to sync and close each one)</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while writing out dirty pages</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../edu/caltech/nanodb/storage/BufferManager.BufferManagerPropertyHandler.html" title="class in edu.caltech.nanodb.storage"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?edu/caltech/nanodb/storage/BufferManager.html" target="_top">Frames</a></li>
<li><a href="BufferManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li><a href="#nested.class.summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
