<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_111) on Wed Jan 18 13:25:14 PST 2017 -->
<title>WALManager (NanoDB)</title>
<meta name="date" content="2017-01-18">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="WALManager (NanoDB)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":9,"i3":10,"i4":10,"i5":10,"i6":10,"i7":9,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":10,"i17":10,"i18":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALFileException.html" title="class in edu.caltech.nanodb.storage.writeahead"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?edu/caltech/nanodb/storage/writeahead/WALManager.html" target="_top">Frames</a></li>
<li><a href="WALManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">edu.caltech.nanodb.storage.writeahead</div>
<h2 title="Class WALManager" class="title">Class WALManager</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>edu.caltech.nanodb.storage.writeahead.WALManager</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.44">WALManager</a>
extends <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></pre>
<div class="block"><p>
 This class manages the write-ahead logs of the database.  There are methods
 to write the different kinds of log records, and also to perform recovery
 based on the contents of the write-ahead logs.  Note that many details of
 transaction coordination are handled by the Transaction Manager, such as
 syncing the write-ahead log, forcing the WAL, and so forth.
 </p>
 <p>
 The actual details of the write-ahead log format are in the package Javadocs:
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/package-summary.html"><code>edu.caltech.nanodb.storage.writeahead</code></a>.
 </p>
 <p>
 Some of the <code>writeXXXX()</code> methods require explicit transaction details,
 while others retrieve the transaction state from thread-local storage.  The
 main difference is that methods that require explicit transaction details are
 needed during recovery processing, when transaction state is dictated by the
 log file, not what is in thread-local storage.
 </p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/BufferManager.html" title="class in edu.caltech.nanodb.storage">BufferManager</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#bufferManager">bufferManager</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#firstLSN">firstLSN</a></span></code>
<div class="block">This object holds the log sequence number of the first write-ahead log
 record where recovery would need to start from.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private static <a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html?is-external=true" title="class or interface in org.apache.log4j">Logger</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#logger">logger</a></span></code>
<div class="block">A logging object for reporting anything interesting that happens.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#MAX_WAL_FILE_NUMBER">MAX_WAL_FILE_NUMBER</a></span></code>
<div class="block">Maximum file number for a write-ahead log file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#MAX_WAL_FILE_SIZE">MAX_WAL_FILE_SIZE</a></span></code>
<div class="block">Maximum size of a write-ahead log file is 10MB.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#nextLSN">nextLSN</a></span></code>
<div class="block">This object holds the log sequence number where the next write-ahead log
 record will be written.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#OFFSET_FIRST_RECORD">OFFSET_FIRST_RECORD</a></span></code>
<div class="block">This is the file-offset of the first log entry in a WAL file.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#OFFSET_PREV_FILE_END">OFFSET_PREV_FILE_END</a></span></code>
<div class="block">This is the file-offset just past the last byte written in the previous
 WAL file, or 0 for the first WAL file.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/StorageManager.html" title="class in edu.caltech.nanodb.storage">StorageManager</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#storageManager">storageManager</a></span></code>&nbsp;</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#WAL_FILENAME_PATTERN">WAL_FILENAME_PATTERN</a></span></code>
<div class="block">Write-ahead log files follow this pattern.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#WALManager-edu.caltech.nanodb.storage.StorageManager-edu.caltech.nanodb.storage.BufferManager-">WALManager</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/StorageManager.html" title="class in edu.caltech.nanodb.storage">StorageManager</a>&nbsp;storageManager,
          <a href="../../../../../edu/caltech/nanodb/storage/BufferManager.html" title="class in edu.caltech.nanodb.storage">BufferManager</a>&nbsp;bufferManager)</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#applyRedo-edu.caltech.nanodb.storage.writeahead.WALRecordType-edu.caltech.nanodb.storage.DBFileReader-edu.caltech.nanodb.storage.DBPage-int-">applyRedo</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type,
         <a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a>&nbsp;walReader,
         <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
         int&nbsp;numSegments)</code>
<div class="block">This helper function writes a sequence of redo-segments from an
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE"><code>WALRecordType.UPDATE_PAGE</code></a> or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE_REDO_ONLY"><code>WALRecordType.UPDATE_PAGE_REDO_ONLY</code></a> record.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private byte[]</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#applyUndoAndGenRedoOnlyData-edu.caltech.nanodb.storage.DBFileReader-edu.caltech.nanodb.storage.DBPage-int-">applyUndoAndGenRedoOnlyData</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a>&nbsp;walReader,
                           <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                           int&nbsp;numSegments)</code>
<div class="block">This helper method uses a <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE"><code>WALRecordType.UPDATE_PAGE</code></a> record to
 undo changes to a data page, and at the same time the method generates
 the data that must go into a corresponding redo-only WAL record.</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>static <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#computeNextLSN-int-int-">computeNextLSN</a></span>(int&nbsp;fileNo,
              int&nbsp;fileOffset)</code>
<div class="block">This static helper function takes the file number of a WAL file, and
 the offset in the WAL file where the next write-ahead log record would
 go if the WAL file can hold more data, and then creates a new
 <code>LogSequenceNumber</code> object, wrapping to the next file if
 necessary.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#createWALFile-int-">createWALFile</a></span>(int&nbsp;fileNo)</code>
<div class="block">This helper method creates a brand new write-ahead log file using the
 Storage Manager, generating a suitable filename and passing the
 appropriate arguments to the Storage Manager.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#doRecovery-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">doRecovery</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;storedFirstLSN,
          <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;storedNextLSN)</code>
<div class="block">Performs recovery processing starting at the specified log sequence
 number, and returns the LSN where the next recovery process should start
 from.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#getFirstLSN--">getFirstLSN</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#getNextLSN--">getNextLSN</a></span>()</code>&nbsp;</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>static <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#getWALFileName-int-">getWALFileName</a></span>(int&nbsp;fileNo)</code>
<div class="block">This static helper method simply takes a WAL file number and translates
 it into a corresponding filename based on that number.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#getWALFileReader-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">getWALFileReader</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;lsn)</code>
<div class="block">This method opens the WAL file specified in the passed-in Log Sequence
 Number, wraps it with a <a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage"><code>DBFileReader</code></a> so that it can be read from,
 and then seeks to the specified file offset.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private <a href="../../../../../edu/caltech/nanodb/storage/DBFileWriter.html" title="class in edu.caltech.nanodb.storage">DBFileWriter</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#getWALFileWriter-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">getWALFileWriter</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;lsn)</code>
<div class="block">This method opens the WAL file specified in the passed-in Log Sequence
 Number, wraps it with a <a href="../../../../../edu/caltech/nanodb/storage/DBFileWriter.html" title="class in edu.caltech.nanodb.storage"><code>DBFileWriter</code></a> so that it can be read and
 written, and then seeks to the specified file offset.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#openWALFile-int-">openWALFile</a></span>(int&nbsp;fileNo)</code>
<div class="block">This helper method opens an existing write-ahead log file using the
 Storage Manager, generating a suitable filename and passing the
 appropriate arguments to the Storage Manager.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#performRedo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-">performRedo</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a>&nbsp;recoveryInfo)</code>
<div class="block">This helper function performs redo processing using the write-ahead
 log.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>private void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#performUndo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-">performUndo</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a>&nbsp;recoveryInfo)</code>
<div class="block">This helper function performs undo processing using the write-ahead
 log.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#rollbackTransaction--">rollbackTransaction</a></span>()</code>
<div class="block">This method performs the operations necessary to rollback the current
 transaction from the database.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeRedoOnlyUpdatePageRecord-edu.caltech.nanodb.storage.DBPage-int-byte:A-">writeRedoOnlyUpdatePageRecord</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                             int&nbsp;numSegments,
                             byte[]&nbsp;changes)</code>
<div class="block">This method writes a redo-only update-page record to the write-ahead log,
 including only redo details.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeRedoOnlyUpdatePageRecord-int-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-edu.caltech.nanodb.storage.DBPage-int-byte:A-">writeRedoOnlyUpdatePageRecord</a></span>(int&nbsp;transactionID,
                             <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;prevLSN,
                             <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                             int&nbsp;numSegments,
                             byte[]&nbsp;changes)</code>
<div class="block">This method writes a redo-only update-page record to the write-ahead log,
 including only redo details.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeTxnRecord-edu.caltech.nanodb.storage.writeahead.WALRecordType-">writeTxnRecord</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type)</code>
<div class="block">This function writes a transaction demarcation record
 (<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>) to the write-ahead log.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeTxnRecord-edu.caltech.nanodb.storage.writeahead.WALRecordType-int-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">writeTxnRecord</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type,
              int&nbsp;transactionID,
              <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;prevLSN)</code>
<div class="block">This function writes a transaction demarcation record
 (<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>) to the write-ahead log.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code><a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeUpdatePageRecord-edu.caltech.nanodb.storage.DBPage-">writeUpdatePageRecord</a></span>(<a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)</code>
<div class="block">This method writes an update-page record to the write-ahead log,
 including both undo and redo details.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone--" title="class or interface in java.lang">clone</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals-java.lang.Object-" title="class or interface in java.lang">equals</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize--" title="class or interface in java.lang">finalize</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass--" title="class or interface in java.lang">getClass</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode--" title="class or interface in java.lang">hashCode</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify--" title="class or interface in java.lang">notify</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll--" title="class or interface in java.lang">notifyAll</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString--" title="class or interface in java.lang">toString</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait--" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-" title="class or interface in java.lang">wait</a>, <a href="http://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait-long-int-" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>private static&nbsp;<a href="http://logging.apache.org/log4j/1.2/apidocs/org/apache/log4j/Logger.html?is-external=true" title="class or interface in org.apache.log4j">Logger</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.47">logger</a></pre>
<div class="block">A logging object for reporting anything interesting that happens.</div>
</li>
</ul>
<a name="WAL_FILENAME_PATTERN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>WAL_FILENAME_PATTERN</h4>
<pre>public static final&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.51">WAL_FILENAME_PATTERN</a></pre>
<div class="block">Write-ahead log files follow this pattern.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#edu.caltech.nanodb.storage.writeahead.WALManager.WAL_FILENAME_PATTERN">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="MAX_WAL_FILE_NUMBER">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_WAL_FILE_NUMBER</h4>
<pre>public static final&nbsp;int <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.57">MAX_WAL_FILE_NUMBER</a></pre>
<div class="block">Maximum file number for a write-ahead log file.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#edu.caltech.nanodb.storage.writeahead.WALManager.MAX_WAL_FILE_NUMBER">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="MAX_WAL_FILE_SIZE">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>MAX_WAL_FILE_SIZE</h4>
<pre>public static final&nbsp;int <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.65">MAX_WAL_FILE_SIZE</a></pre>
<div class="block">Maximum size of a write-ahead log file is 10MB.  When the current WAL
 file reaches this size, it is closed and a new WAL file is created with
 the next increasing file number.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#edu.caltech.nanodb.storage.writeahead.WALManager.MAX_WAL_FILE_SIZE">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="OFFSET_PREV_FILE_END">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OFFSET_PREV_FILE_END</h4>
<pre>public static final&nbsp;int <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.73">OFFSET_PREV_FILE_END</a></pre>
<div class="block">This is the file-offset just past the last byte written in the previous
 WAL file, or 0 for the first WAL file.  The value is an integer,
 occupying 4 bytes.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#edu.caltech.nanodb.storage.writeahead.WALManager.OFFSET_PREV_FILE_END">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="OFFSET_FIRST_RECORD">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>OFFSET_FIRST_RECORD</h4>
<pre>public static final&nbsp;int <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.79">OFFSET_FIRST_RECORD</a></pre>
<div class="block">This is the file-offset of the first log entry in a WAL file.</div>
<dl>
<dt><span class="seeLabel">See Also:</span></dt>
<dd><a href="../../../../../constant-values.html#edu.caltech.nanodb.storage.writeahead.WALManager.OFFSET_FIRST_RECORD">Constant Field Values</a></dd>
</dl>
</li>
</ul>
<a name="storageManager">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>storageManager</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/StorageManager.html" title="class in edu.caltech.nanodb.storage">StorageManager</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.95">storageManager</a></pre>
</li>
</ul>
<a name="bufferManager">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>bufferManager</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/BufferManager.html" title="class in edu.caltech.nanodb.storage">BufferManager</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.98">bufferManager</a></pre>
</li>
</ul>
<a name="firstLSN">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>firstLSN</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.105">firstLSN</a></pre>
<div class="block">This object holds the log sequence number of the first write-ahead log
 record where recovery would need to start from.</div>
</li>
</ul>
<a name="nextLSN">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>nextLSN</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a> <a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.112">nextLSN</a></pre>
<div class="block">This object holds the log sequence number where the next write-ahead log
 record will be written.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="WALManager-edu.caltech.nanodb.storage.StorageManager-edu.caltech.nanodb.storage.BufferManager-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>WALManager</h4>
<pre>public&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.115">WALManager</a>(<a href="../../../../../edu/caltech/nanodb/storage/StorageManager.html" title="class in edu.caltech.nanodb.storage">StorageManager</a>&nbsp;storageManager,
                  <a href="../../../../../edu/caltech/nanodb/storage/BufferManager.html" title="class in edu.caltech.nanodb.storage">BufferManager</a>&nbsp;bufferManager)</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getWALFileName-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWALFileName</h4>
<pre>public static&nbsp;<a href="http://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.90">getWALFileName</a>(int&nbsp;fileNo)</pre>
<div class="block">This static helper method simply takes a WAL file number and translates
 it into a corresponding filename based on that number.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fileNo</code> - the WAL file number to get the filename for</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the string file-name for the corresponding WAL file</dd>
</dl>
</li>
</ul>
<a name="createWALFile-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createWALFile</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.133">createWALFile</a>(int&nbsp;fileNo)
                     throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper method creates a brand new write-ahead log file using the
 Storage Manager, generating a suitable filename and passing the
 appropriate arguments to the Storage Manager.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fileNo</code> - the number of the WAL file to create</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> for the newly created and opened WAL file</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the file cannot be created for some reason</dd>
</dl>
</li>
</ul>
<a name="openWALFile-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>openWALFile</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage">DBFile</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.154">openWALFile</a>(int&nbsp;fileNo)
                   throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper method opens an existing write-ahead log file using the
 Storage Manager, generating a suitable filename and passing the
 appropriate arguments to the Storage Manager.  Of course, if the file has
 already been opened, the Storage Manager will return the <code>DBFile</code>
 from its cache.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fileNo</code> - the number of the WAL file to open</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <a href="../../../../../edu/caltech/nanodb/storage/DBFile.html" title="class in edu.caltech.nanodb.storage"><code>DBFile</code></a> for the opened WAL file</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the file cannot be opened for some reason, such
         as if the file doesn't exist, or if permissions are incorrect</dd>
</dl>
</li>
</ul>
<a name="getFirstLSN--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getFirstLSN</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.170">getFirstLSN</a>()</pre>
</li>
</ul>
<a name="getNextLSN--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNextLSN</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.175">getNextLSN</a>()</pre>
</li>
</ul>
<a name="doRecovery-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>doRecovery</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.196">doRecovery</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;storedFirstLSN,
                               <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;storedNextLSN)
                        throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Performs recovery processing starting at the specified log sequence
 number, and returns the LSN where the next recovery process should start
 from.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>storedFirstLSN</code> - the location of the write-ahead log record where
        recovery should start from</dd>
<dd><code>storedNextLSN</code> - the location in the write-ahead log that is
        <em>just past</em> the last valid log record in the WAL</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the new location where recovery should start from the next time
         recovery processing is performed</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs during recovery processing</dd>
</dl>
</li>
</ul>
<a name="performRedo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>performRedo</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.241">performRedo</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a>&nbsp;recoveryInfo)
                  throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper function performs redo processing using the write-ahead
 log.  As the log is traversed, the <tt>RecoveryInfo</tt> object is also
 updated with important redo/undo information.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>recoveryInfo</code> - the object used to track information about specific
        transactions during recovery processing.  This object will be
        passed to <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#performUndo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-"><code>performUndo(edu.caltech.nanodb.storage.writeahead.RecoveryInfo)</code></a>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="performUndo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>performUndo</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.309">performUndo</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/RecoveryInfo.html" title="class in edu.caltech.nanodb.storage.writeahead">RecoveryInfo</a>&nbsp;recoveryInfo)
                  throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper function performs undo processing using the write-ahead
 log.  As the log is traversed backwards, the <tt>RecoveryInfo</tt>
 object is also updated with important redo/undo information.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>recoveryInfo</code> - the object used to track information about specific
        transactions during recovery processing.  This object is
        populated by a previous call to <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#performRedo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-"><code>performRedo(edu.caltech.nanodb.storage.writeahead.RecoveryInfo)</code></a>.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="computeNextLSN-int-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>computeNextLSN</h4>
<pre>public static&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.471">computeNextLSN</a>(int&nbsp;fileNo,
                                               int&nbsp;fileOffset)</pre>
<div class="block">This static helper function takes the file number of a WAL file, and
 the offset in the WAL file where the next write-ahead log record would
 go if the WAL file can hold more data, and then creates a new
 <code>LogSequenceNumber</code> object, wrapping to the next file if
 necessary.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>fileNo</code> - the number of the current WAL file</dd>
<dd><code>fileOffset</code> - the offset of where the next write-ahead log record
        would go, in the absence of wrapping to the next file</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a <code>LogSequenceNumber</code> object that takes wrapping into
         account</dd>
</dl>
</li>
</ul>
<a name="getWALFileWriter-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWALFileWriter</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/DBFileWriter.html" title="class in edu.caltech.nanodb.storage">DBFileWriter</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.506">getWALFileWriter</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;lsn)
                               throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method opens the WAL file specified in the passed-in Log Sequence
 Number, wraps it with a <a href="../../../../../edu/caltech/nanodb/storage/DBFileWriter.html" title="class in edu.caltech.nanodb.storage"><code>DBFileWriter</code></a> so that it can be read and
 written, and then seeks to the specified file offset.

 Because we are writing, the file may not yet exist.  In that case, this
 method will also create a new WAL file for the specified file number,
 initializing it with the proper values, and then seeking to the location
 where the first WAL record may be written.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lsn</code> - The log sequence number specifying the WAL file and the offset
            in the WAL file to go to.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the WAL file, with the file position moved to the specified
         offset.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the corresponding WAL file cannot be opened, or
         if some other IO error occurs.</dd>
</dl>
</li>
</ul>
<a name="getWALFileReader-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getWALFileReader</h4>
<pre>private&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.547">getWALFileReader</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;lsn)
                               throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method opens the WAL file specified in the passed-in Log Sequence
 Number, wraps it with a <a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage"><code>DBFileReader</code></a> so that it can be read from,
 and then seeks to the specified file offset.

 Since we are reading, the expectation is that the file already
 exists, so a <a href="http://docs.oracle.com/javase/7/docs/api/java/io/FileNotFoundException.html?is-external=true" title="class or interface in java.io"><code>FileNotFoundException</code></a> will be thrown if it
 does not exist.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>lsn</code> - The log sequence number specifying the WAL file and the offset
            in the WAL file to go to.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the WAL file, with the file position moved to the specified
         offset.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while opening the WAL file,
         such as the required file not actually existing.</dd>
</dl>
</li>
</ul>
<a name="writeTxnRecord-edu.caltech.nanodb.storage.writeahead.WALRecordType-int-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeTxnRecord</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.589">writeTxnRecord</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type,
                                        int&nbsp;transactionID,
                                        <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;prevLSN)
                                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This function writes a transaction demarcation record
 (<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>) to the write-ahead log.  The transaction
 state is passed explicitly so that this method can be used during
 recovery processing.  The alternate method
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeTxnRecord-edu.caltech.nanodb.storage.writeahead.WALRecordType-"><code>writeTxnRecord(WALRecordType)</code></a> retrieves the transaction state
 from thread-local storage, and should be used during normal operation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - The type of the transaction demarcation to write, one of the
        values <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>,
        or <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>.</dd>
<dd><code>transactionID</code> - the transaction ID that the WAL record is for</dd>
<dd><code>prevLSN</code> - the log sequence number of the transaction's immediately
        previous WAL record, if the record type is either a commit or
        abort record.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the Log Sequence Number of the WAL record that was written</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the write-ahead log can't be updated for some
         reason.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <tt>type</tt> is <tt>null</tt>, or if
         it isn't one of the values <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>,
         <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>.</dd>
</dl>
</li>
</ul>
<a name="writeTxnRecord-edu.caltech.nanodb.storage.writeahead.WALRecordType-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeTxnRecord</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.659">writeTxnRecord</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type)
                                 throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This function writes a transaction demarcation record
 (<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>) to the write-ahead log.  The transaction
 state is retrieved from thread-local storage so that it doesn't need to
 be passed.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - The type of the transaction demarcation to write, one of the
        values <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>, <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>,
        or <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the Log Sequence Number of the WAL record that was written</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the write-ahead log can't be updated for some
         reason.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <tt>type</tt> is <tt>null</tt>, or if
         it isn't one of the values <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#START_TXN"><code>WALRecordType.START_TXN</code></a>,
         <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#COMMIT_TXN"><code>WALRecordType.COMMIT_TXN</code></a>, or <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#ABORT_TXN"><code>WALRecordType.ABORT_TXN</code></a>.</dd>
</dl>
</li>
</ul>
<a name="writeUpdatePageRecord-edu.caltech.nanodb.storage.DBPage-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeUpdatePageRecord</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.692">writeUpdatePageRecord</a>(<a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage)
                                        throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes an update-page record to the write-ahead log,
 including both undo and redo details.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbPage</code> - The data page whose changes are to be recorded in the log.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the Log Sequence Number of the WAL record that was written</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the write-ahead log cannot be updated for some
         reason.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <tt>dbPage</tt> is <tt>null</tt>, or
         if it shows no updates.</dd>
</dl>
</li>
</ul>
<a name="applyRedo-edu.caltech.nanodb.storage.writeahead.WALRecordType-edu.caltech.nanodb.storage.DBFileReader-edu.caltech.nanodb.storage.DBPage-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>applyRedo</h4>
<pre>private&nbsp;void&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.843">applyRedo</a>(<a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead">WALRecordType</a>&nbsp;type,
                       <a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a>&nbsp;walReader,
                       <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                       int&nbsp;numSegments)
                throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper function writes a sequence of redo-segments from an
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE"><code>WALRecordType.UPDATE_PAGE</code></a> or
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE_REDO_ONLY"><code>WALRecordType.UPDATE_PAGE_REDO_ONLY</code></a> record.  Note that the
 <code>walReader</code> argument is expected to be positioned at the start of
 the segments containing the old and new versions of the page data (or
 just the new versions, for redo-only records).  Additionally, the
 reader position will be advanced by this method.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>type</code> - The record type, either <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE"><code>WALRecordType.UPDATE_PAGE</code></a>
        or <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE_REDO_ONLY"><code>WALRecordType.UPDATE_PAGE_REDO_ONLY</code></a>.</dd>
<dd><code>walReader</code> - A reader positioned at the start of the redo/undo data
        to apply to the data page.  This method will advance the reader's
        position past this redo/undo data.</dd>
<dd><code>dbPage</code> - the page that the redo should be applied to</dd>
<dd><code>numSegments</code> - the number of segments containing redo[/undo] data;
        this value is expected to already be unpacked from the log record</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code></dd>
</dl>
</li>
</ul>
<a name="applyUndoAndGenRedoOnlyData-edu.caltech.nanodb.storage.DBFileReader-edu.caltech.nanodb.storage.DBPage-int-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>applyUndoAndGenRedoOnlyData</h4>
<pre>private&nbsp;byte[]&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.890">applyUndoAndGenRedoOnlyData</a>(<a href="../../../../../edu/caltech/nanodb/storage/DBFileReader.html" title="class in edu.caltech.nanodb.storage">DBFileReader</a>&nbsp;walReader,
                                           <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                                           int&nbsp;numSegments)
                                    throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This helper method uses a <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html#UPDATE_PAGE"><code>WALRecordType.UPDATE_PAGE</code></a> record to
 undo changes to a data page, and at the same time the method generates
 the data that must go into a corresponding redo-only WAL record.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>walReader</code> - A reader positioned at the start of the redo/undo data
        to apply to the data page.  This method will advance the reader's
        position past this redo/undo data.</dd>
<dd><code>dbPage</code> - the data page that undo operations should be applied to</dd>
<dd><code>numSegments</code> - the number of segments in the redo/undo data</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>a byte-array containing the same number of segments as the
         original update record, with only the data necessary for the
         redo-only record.</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs while applying the undo
         operation</dd>
</dl>
</li>
</ul>
<a name="writeRedoOnlyUpdatePageRecord-int-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-edu.caltech.nanodb.storage.DBPage-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRedoOnlyUpdatePageRecord</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.949">writeRedoOnlyUpdatePageRecord</a>(int&nbsp;transactionID,
                                                       <a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;prevLSN,
                                                       <a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                                                       int&nbsp;numSegments,
                                                       byte[]&nbsp;changes)
                                                throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes a redo-only update-page record to the write-ahead log,
 including only redo details.  The transaction state is passed explicitly
 so that this method can be used during recovery processing.  The
 alternate method
 <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeRedoOnlyUpdatePageRecord-edu.caltech.nanodb.storage.DBPage-int-byte:A-"><code>writeRedoOnlyUpdatePageRecord(DBPage, int, byte[])</code></a> retrieves
 the transaction state from thread-local storage, and should be used
 during normal operation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>transactionID</code> - the transaction ID that the WAL record is for.</dd>
<dd><code>prevLSN</code> - the log sequence number of the transaction's immediately
        previous WAL record.</dd>
<dd><code>dbPage</code> - The data page whose changes are to be recorded in the log.</dd>
<dd><code>numSegments</code> - The number of segments in the change-data to record.</dd>
<dd><code>changes</code> - The actual changes themselves, serialized to a byte array.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the Log Sequence Number of the WAL record that was written</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the write-ahead log cannot be updated for some
         reason.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <tt>dbPage</tt> is <tt>null</tt>, or
         if <tt>changes</tt> is <tt>null</tt>.</dd>
</dl>
</li>
</ul>
<a name="writeRedoOnlyUpdatePageRecord-edu.caltech.nanodb.storage.DBPage-int-byte:A-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>writeRedoOnlyUpdatePageRecord</h4>
<pre>public&nbsp;<a href="../../../../../edu/caltech/nanodb/storage/writeahead/LogSequenceNumber.html" title="class in edu.caltech.nanodb.storage.writeahead">LogSequenceNumber</a>&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.1022">writeRedoOnlyUpdatePageRecord</a>(<a href="../../../../../edu/caltech/nanodb/storage/DBPage.html" title="class in edu.caltech.nanodb.storage">DBPage</a>&nbsp;dbPage,
                                                       int&nbsp;numSegments,
                                                       byte[]&nbsp;changes)
                                                throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method writes a redo-only update-page record to the write-ahead log,
 including only redo details.  The transaction state is taken from
 thread-local storage; this method should be used during normal operation.

 The alternate method <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#writeRedoOnlyUpdatePageRecord-int-edu.caltech.nanodb.storage.writeahead.LogSequenceNumber-edu.caltech.nanodb.storage.DBPage-int-byte:A-"><code>writeRedoOnlyUpdatePageRecord(int,
 LogSequenceNumber, DBPage, int, byte[])</code></a> should be used during recovery
 processing when transaction state is specifically known.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>dbPage</code> - The data page whose changes are to be recorded in the log.</dd>
<dd><code>numSegments</code> - The number of segments in the change-data to record.</dd>
<dd><code>changes</code> - The actual changes themselves, serialized to a byte array.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the Log Sequence Number of the WAL record that was written</dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if the write-ahead log cannot be updated for some
         reason.</dd>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <tt>dbPage</tt> is <tt>null</tt>, or
         if <tt>changes</tt> is <tt>null</tt>.</dd>
</dl>
</li>
</ul>
<a name="rollbackTransaction--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>rollbackTransaction</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../../src-html/edu/caltech/nanodb/storage/writeahead/WALManager.html#line.1051">rollbackTransaction</a>()
                         throws <a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">This method performs the operations necessary to rollback the current
 transaction from the database.  The transaction details are taken from
 the transaction state stored in thread-local storage.  This method is
 not used during recovery processing; the <a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALManager.html#performUndo-edu.caltech.nanodb.storage.writeahead.RecoveryInfo-"><code>performUndo(edu.caltech.nanodb.storage.writeahead.RecoveryInfo)</code></a> method is
 used to rollback all incomplete transactions in the logs.</div>
<dl>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><a href="http://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an IO error occurs during rollback.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALFileException.html" title="class in edu.caltech.nanodb.storage.writeahead"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../../../edu/caltech/nanodb/storage/writeahead/WALRecordType.html" title="enum in edu.caltech.nanodb.storage.writeahead"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?edu/caltech/nanodb/storage/writeahead/WALManager.html" target="_top">Frames</a></li>
<li><a href="WALManager.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
